<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Paul Hegedus" />


<title>Methods</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ESA2020-Hegedus</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="introduction.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Methods
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="methods.html">Overview</a>
    </li>
    <li>
      <a href="data_prep.html">Data Preparation</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Field Analysis</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="analysis_sec1east.html">sec1east</a>
        </li>
        <li>
          <a href="analysis_sec1west.html">sec1west</a>
        </li>
        <li>
          <a href="analysis_sec35mid.html">sec35middle</a>
        </li>
        <li>
          <a href="analysis_carlinwest.html">carlinwest</a>
        </li>
        <li>
          <a href="analysis_henrys.html">henrys</a>
        </li>
        <li>
          <a href="analysis_minnies.html">minnies</a>
        </li>
        <li>
          <a href="analysis_sre910.html">sre910</a>
        </li>
        <li>
          <a href="analysis_gramsmoms.html">gramsmoms</a>
        </li>
        <li>
          <a href="analysis_sre1314.html">sre1314</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li>
  <a href="resultsNdiscussion.html">Results &amp; Discussion</a>
</li>
<li>
  <a href="references.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Methods</h1>
<h4 class="author">Paul Hegedus</h4>

</div>


<p>This research was conducted using farmers collaborating with the OFPE project at MSU. The OFPE framework for nitrogen fertilizer (N) management began on eight dryland fields at four conventionally managed farms beginning in 2015 and has continued to do N-rate experiments on these fields in crop-fallow or crop-pulse crop rotations. The OFPE project has expanded to include five certified organic farms that are experimentally manipulating green manure crop seeding rates and following year wheat seeding rates to maximize profit and minimize weed populations. Potential farmer collaborators for the OFPE are evaluated based on their willingness to participate in the OFPE study for up to 10 years, their experience with PA technologies (yield monitor, and protein monitoring data), and variable fertilizer/seed rate application (VRA) in dryland winter wheat production.</p>
<p>Three of the four conventional farms were selected for this study because of their data availability and quality and our focus on N fertilizer management. There were 3 fields on farm B, three fields on farm I, and one fields on farm D (Fig. 1, Table 1). <img src="images/fig1.png" alt="Figure 1" /> <img src="images/table1.png" alt="Table 1" />. These three producers were selected from the larger set of nine farmer collaborators, of which eight were selected from a survey sent to Montana small grain producers and one Canadian farmer were recruited. Fields selected were required to have experimental N data available from at least two years, as well as observed yield and protein measurements from across the entire the field. Nitrogen fertilizer rates were experientially applied across the field in blocks varying from 400 – 600 feet long and as wide as the farmer’s fertilize sprayer or spreader width, varying from 70 – 120 feet wide. Rates were randomly placed throughout the field, stratified on previous yield, protein, and N applied (Fig. 2). <img src="images/fig2.png" alt="Figure 2" /></p>
<p>In conjunction with the Computer Science Department at MSU, a Python based computer application called Stratified Treatment Application Rates (STAR) was developed for the OFPE project for optimally applying experimental the N fertilizer trials within fields (Peerlinck, Sheppard, Pastorino, &amp; Maxwell, 2019). The application (Fig. 3) receives several .csv files as input, which contain data regarding the field for which the experimental trial has to be created. The “field shape” .csv file is used to create a grid layout over the field, which adheres to the shape of the field. If the field already has a grid layout available, this can also be provided to the application, which means a new grid does not have to be created, saving time. Each grid cell is then assigned a nitrogen rate based on a previous year’s yield and, optionally, protein, which are provided by the user. The yield and protein values are used to determine which “bin” a specific grid cell belongs to. Bins can be delineated by the data values or number of observations, are then used to assign stratified experimental rates across the bins. The user can choose which experimental nitrogen rates to apply across the field. The application has the option to perform “rate change optimization” that uses a Genetic Algorithm to reduce large nitrogen rate jumps between consecutive cells, as this is hard on the application equipment.</p>
<p>The response variables of interest are crop productivity (yield in bushels per acre) and quality (grain protein percent), both of which are gathered from monitors mounted in the cab of the farmer’s combine harvesters. Data from yield monitors are gathered an average of every three seconds and have become standard issue on most modern combines. Farm equipment used in this study varied between farmers and ranged from John Deere to Case. All yield monitors are calibrated every spring by the farmers, according to their respective manufacturing instructions. Grain protein content was measured with <a href="http://www.nextinstruments.net/index.php/products/cropscan/cropscan-3300h-on-header-analyser">Next Instrument’s CropScan 3300H</a> near infrared monitor which was installed, maintained, and calibrated by <a href="https://www.triangleag.com">Triangle Ag Crop Consultants</a>. These data each are subjected to proprietary cleaning practices according to the software of the machine used to make the measurement and are subjected to further cleaning before analysis, including removal of observations where the yield/protein or distance from the next point in time was above or below 4SD from the mean, and removal of points within 30m of field boundary (Blackmore &amp; Moore, 1999; Sudduth &amp; Drummond, 2007; Sudduth, Drummond, &amp; Myers, 2012). In addition to the yield, protein, and as-applied N data that are collected from the machines on the field, remotely sensed covariate data from open sources was gathered (Table 2). These data were gathered or derived from Google Earth Engine (Gorelick et al. 2017) and aggregated together at the locations of the observations in the yield and protein datasets. In some cases, the resolution of the data was greater than the size of the field, dictating that variation in this covariate is due to year to year differences. <img src="images/table2.png" alt="Table 2" /></p>
<p>Net-return was also a response variable of interest. Net-return is calculated as; <span class="math display">\[PD = \beta_0 + \beta_1Protein + \beta_2Protein^2 \]</span> Where PD is the equation for protein premiums and dockages, and is fit using data from the Billings grain elevator in 2016 (most recent data available).</p>
<p><span class="math display">\[Price Received = Bp + \beta_0PD + \beta_1PDProtein + \beta_2PDProtein^2\]</span> Where the price received is a function of Bp, the base-price received for wheat, and the coefficients of the PD equaiton and observed protein.</p>
<p><span class="math display">\[NetReturn = Yield * PriceReceived - CN*N - FC\]</span> Where CN is the cost of nitrogen in dollars per pound, N is the pounds per acre of fertilizer applied, and FC are fixed costs associated per acre that are not related to fertilizer. The net-return in dollars per acre is equal to the yield multiplied by the price received with the cost of nitrogen and fixed costs subtracted.</p>
<p>A generalized additive model was fit with the OFPE parameters on training datasets and used for predicting both wheat yield, grain protein percent, and net-returns. Each model was fit for each field and year in the study and then subjected to a full sensitivity analysis where the value of all experimental variables and covariates were systematically increased and decreased by 10% individually. The change in estimated response for each point is recorded for the comparison of each change to the observed values to determine which variable contributed to the largest change in observed crop response. This was repeated for every field and year.</p>
<p>All data analysis was performed using R (R Core Team, 2020). The sensitivity of both yield and grain protein percent for each field was evaluated by calculating the elasticity compared to the default observed conditions. Elasticity was calculated as the absolute value of the difference between the average crop response in the default condition to the average crop response in the altered condition (with a covariate increased or decreased by 10%). The most elastic variables were grouped for each field across years and between fields by farms to assess trends in drivers of crop productivity and quality across space and time.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
